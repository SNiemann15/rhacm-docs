[#troubleshooting-reimporting-a-managed-cluster]
= Troubleshooting reimporting a managed cluster

When you remove a cluster from management that is in the offline status, you might have trouble reimporting the cluster for management.

[#symptom-reimporting-cluster]
== Symptom: Reimporting a detached cluster fails

After you detach a cluster and try to import it again, an error occurs. The error message looks similar to the following example: 

----
"error":"failed to install release: rendered manifests contain a resource that already exists. Unable to continue with install: ClusterRole "cert-policy-controller-role" in namespace "" exists and cannot be imported into the current release: invalid ownership metadata;
...
----

[#cause-reimporting-cluster]
== Cause: Reimporting a detached cluster fails

This error occurs when a cluster is detached from the hub cluster, but some of the resources remain. 

[#resolving-reimporting-cluster]
== Resolving the problem: Reimporting a detached cluster fails

To resolve this problem, you must clean up the remaining resources, and reimport the cluster. Complete the following steps:

. Make sure you have the `oc` command line interface configured.
. Make sure you have `KUBECONFIG` configured on your managed cluster.
+ 
If you run `oc get ns | grep open-cluster-management-agent` you should see two namespaces:
+
----
open-cluster-management-agent         Active   10m
open-cluster-management-agent-addon   Active   10m
----

. Download the link:https://github.com/open-cluster-management/deploy/blob/master/hack/cleanup-managed-cluster.sh[`cleanup-managed-cluster`] script from the `deploy` Git repository.
. Run the `cleanup-managed-cluster.sh` script by entering the following command:
+
----
./cleanup-managed-cluster.sh
----
. Run the following command to ensure that both namespaces are removed: 
+
----
oc get ns | grep open-cluster-management-agent 
----
. Import the managed cluster again.
