[#troubleshooting-reimporting-a-managed-cluster]
= Troubleshooting reimporting a managed cluster

When you remove an offline cluster from management, you might see errors when reimporting the cluster.

[#symptom-reimporting-cluster]
== Symptom: Reimporting a detached cluster fails

When you detach a managed cluster that is offline from the hub cluster, not all of the resources can be removed from the managed cluster. It might cause errors when you try to reimport it. The error message looks similar to the following example: 

----
"error":"failed to install release: rendered manifests contain a resource that already exists. Unable to continue with install: ClusterRole "cert-policy-controller-role" in namespace "" exists and cannot be imported into the current release: invalid ownership metadata;
...
----

[#cause-reimporting-cluster]
== Cause: Reimporting a detached cluster fails

This error occurs when an offline managed cluster is detached from the hub cluster, and some of the resources remain. When it is reimported, the import process fails because the remaining resources prevent a clean import.  

[#resolving-reimporting-cluster]
== Resolving the problem: Reimporting a detached cluster fails

*NOTE:* This results of this procedure might vary if manual steps were taken to delete the operator.

To resolve this problem, you must clean up the remaining resources that are on the managed cluster, and reimport the cluster. Complete the following steps to remove the remaining resources from the managed cluster:

. Make sure you have the `oc` command line interface configured.
. Make sure you have `KUBECONFIG` configured on your managed cluster.
+ 
If you run `oc get ns | grep open-cluster-management-agent` you should see two namespaces:
+
----
open-cluster-management-agent         Active   10m
open-cluster-management-agent-addon   Active   10m
----

. Download the link:https://github.com/open-cluster-management/deploy/blob/master/hack/cleanup-managed-cluster.sh[`cleanup-managed-cluster`] script from the `deploy` Git repository.
. Run the `cleanup-managed-cluster.sh` script by entering the following command:
+
----
./cleanup-managed-cluster.sh
----
. Run the following command to ensure that both namespaces are removed: 
+
----
oc get ns | grep open-cluster-management-agent 
----
. Import the managed cluster again.
